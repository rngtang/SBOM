import {useState, useEffect} from 'react'
import * as React from 'react'
import styles from './Vulnerability.module.css';
import sbom1 from '../data/vuln.json';

const Intro = ({ userId, title, vulnerabilityID, affectedPackage, source, sourceLink, vulnerabilitySeverity, score, visitLink }) => {
// const Intro = ({userId}) => {
    const [sboms, setSboms] = useState([])
    const sbomsUrl = 'http://localhost:8080/sboms/1/vulnerabilities';

    const fetch = () => {
        fetch(sbomsUrl)
            .then((response) => response.json())
            .then((data) => {
                console.log(data)
                setSboms(data)
            })
    }
    
    useEffect(() => {
        fetchSboms()
        // console.log("was triggered");
        console.log("CURRENT USER, from get: ", userId);
    }, [])


    return (
        <>
        <p>testing</p>
        <div className={styles.section}>
            {sboms.map((sbom => {
            <div>
                <h2 className={styles.h2}>{title}</h2>
                <p><strong>Vulnerability ID: </strong>
                    {sbom.vulnID}
                </p>

                <p>---</p>

                <p><strong>Affected Package(s): </strong>
                    {affectedPackage.join(", ")}
                </p>

                <p><strong>Source: </strong>
                    <a href={sourceLink} target="_blank" style={{ fontWeight: 'bolder', color: 'var(--dukeblue)' }}>
                        {source}
                    </a>
                </p>

                <p><strong>Vulnerability Severity: </strong>
                    {vulnerabilitySeverity}
                </p>

                <p><strong>Score: </strong>
                    {score}
                </p>

                <p><strong>Visit this link to learn more: </strong>
                    <a href={visitLink} target="_blank" style={{ fontWeight: 'bolder', color: 'var(--dukeblue)' }}>
                        {visitLink}
                    </a>
                </p>
            </div>
            }))}
        </div>
        </>
    );
};

const Vulnerability = () => {
    return (
        <>
            <Intro
                title={sbom1.title}
                vulnerabilityID={sbom1.vulnerabilityID}
                affectedPackage={sbom1.affectedPackage}
                source={sbom1.source}
                sourceLink={sbom1.sourceLink}
                vulnerabilitySeverity={sbom1.vulnerabilitySeverity}
                score={sbom1.score}
                visitLink={sbom1.visitLink}
            />
        </>
    );
};

export default Vulnerability;
