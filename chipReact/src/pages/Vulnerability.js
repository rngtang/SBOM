import {useState, useEffect} from 'react'
import * as React from 'react'
import styles from './Vulnerability.module.css';
import sbom1 from '../data/vuln.json';

const Intro = ({sbomId}) => {
    const [vulns, setVulns] = useState([])
    // const sbomsUrl = 'http://localhost:8080/sboms/1/vulnerabilities'; //vulnerabilities are associated w/ sbom 
    const sbomsUrl = `http://localhost:8080/sboms/${sbomId}/vulnerabilities`;

    const fetchVulns = () => {
        fetch(sbomsUrl)
            .then((response) => response.json())
            .then((data) => {
                console.log(data);
                setVulns(data);
            })
    }
    
    useEffect(() => {
        fetchVulns();
        console.log("getting all vulnerabilities for sbom 1");
    }, [])


    return (
        <>
            <p>testing</p>
            {
                vulns.map((vuln => {
                    return (
                        <>
                        <div className={styles.section}>
                          {vuln.id && <p key={`id-${vuln.id}`}><strong>Current Vulnerability: </strong>{vuln.id}</p>}
                          {vuln.vulnID && <p key={`vulnID-${vuln.vulnID}`}><strong>Vulnerability ID: </strong>{vuln.vulnID}</p>}
                        </div>
                        </>
                      ); 

                }))
            }
        </>
    )
}

//         {/*  */}
//             {/* {vulns.map((vuln => {
//             <div key={vuln.vulnID} >
//                 {/*  */}
// {/* 
//                 <p>
//                     {vuln.vulnId}
//                 </p> */} 

//                 {/* <p>---</p>

//                 <p><strong>Affected Package(s): </strong>
//                     {affectedPackage.join(", ")}
//                 </p>

//                 <p><strong>Source: </strong>
//                     <a href={sourceLink} target="_blank" style={{ fontWeight: 'bolder', color: 'var(--dukeblue)' }}>
//                         {source}
//                     </a>
//                 </p>

//                 <p><strong>Vulnerability Severity: </strong>
//                     {vulnerabilitySeverity}
//                 </p>

//                 <p><strong>Score: </strong>
//                     {score}
//                 </p>

//                 <p><strong>Visit this link to learn more: </strong>
//                     <a href={visitLink} target="_blank" style={{ fontWeight: 'bolder', color: 'var(--dukeblue)' }}>
//                         {visitLink}
//                     </a>
//                 </p> */}
//             {/* </div>
//             }))}
//         </div> */}

const Vulnerability = () => {
    return (
        <>
            <Intro sbomId={1}/>
        </> 
    );
};

export default Vulnerability;
